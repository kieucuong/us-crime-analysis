{"paragraphs":[{"text":"import spark.implicits._","user":"anonymous","dateUpdated":"2018-05-07T17:16:56+0900","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\n"}]},"apps":[],"jobName":"paragraph_1524756607601_-813739213","id":"20180426-163007_1099128315","dateCreated":"2018-04-26T16:30:07+0900","dateStarted":"2018-05-07T17:16:56+0900","dateFinished":"2018-05-07T17:17:07+0900","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:207"},{"text":"val crimeFeatures = spark.read\n  .option(\"inferSchema\", true)\n  .option(\"header\", true)\n  .csv(\"/Users/kc250033/dev/us-crime-analysis/data/merge\")\n  \ncrimeFeatures.printSchema\n\ncrimeFeatures.count","user":"anonymous","dateUpdated":"2018-05-07T17:17:18+0900","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"crimeFeatures: org.apache.spark.sql.DataFrame = [county: string, year: int ... 27 more fields]\nroot\n |-- county: string (nullable = true)\n |-- year: integer (nullable = true)\n |-- violent_crime_rate: double (nullable = true)\n |-- property_crime_rate: double (nullable = true)\n |-- poverty_estimate_all_ages: integer (nullable = true)\n |-- poverty_percent_all_ages: double (nullable = true)\n |-- poverty_estimate_under_age_18: integer (nullable = true)\n |-- poverty_percent_under_ age_18: double (nullable = true)\n |-- poverty_estimate_ages_5-17: integer (nullable = true)\n |-- poverty_percent_ages_5-17: double (nullable = true)\n |-- median_household_income: integer (nullable = true)\n |-- labor_force: integer (nullable = true)\n |-- employed: integer (nullable = true)\n |-- unemployed_level: integer (nullable = true)\n |-- unemployed_rate: double (nullable = true)\n |-- cum_population_change: integer (nullable = true)\n |-- cum_natural_increase: integer (nullable = true)\n |-- cum_births: integer (nullable = true)\n |-- cum_deaths: integer (nullable = true)\n |-- cum_net_migration: integer (nullable = true)\n |-- cum_intl_migration: integer (nullable = true)\n |-- cum_dom_migration: integer (nullable = true)\n |-- population_change: integer (nullable = true)\n |-- natural_increase: integer (nullable = true)\n |-- births: integer (nullable = true)\n |-- deaths: integer (nullable = true)\n |-- net_migration: integer (nullable = true)\n |-- intl_migration: integer (nullable = true)\n |-- dom_migration: integer (nullable = true)\n\nres3: Long = 176\n"}]},"apps":[],"jobName":"paragraph_1524756576357_995872781","id":"20180426-162936_1507098582","dateCreated":"2018-04-26T16:29:36+0900","dateStarted":"2018-05-07T17:17:18+0900","dateFinished":"2018-05-07T17:17:28+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208"},{"text":"z.show(crimeFeatures.filter($\"year\" === 2014))","user":"anonymous","dateUpdated":"2018-05-07T17:17:32+0900","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"county\tyear\tviolent_crime_rate\tproperty_crime_rate\tpoverty_estimate_all_ages\tpoverty_percent_all_ages\tpoverty_estimate_under_age_18\tpoverty_percent_under_ age_18\tpoverty_estimate_ages_5-17\tpoverty_percent_ages_5-17\tmedian_household_income\tlabor_force\temployed\tunemployed_level\tunemployed_rate\tcum_population_change\tcum_natural_increase\tcum_births\tcum_deaths\tcum_net_migration\tcum_intl_migration\tcum_dom_migration\tpopulation_change\tnatural_increase\tbirths\tdeaths\tnet_migration\tintl_migration\tdom_migration\nContra Costa County\t2014\t4992.6\t51438.3\t115466\t10.5\t35640\t13.8\t25628\t13.3\t80338\t540891\t507521\t33370\t6.2\t62142\t20382\t51614\t31232\t41374\t17009\t24365\t15359\t4477\t12221\t7744\t11125\t4265\t6860\nSanta Clara County\t2014\t1905.8\t26178.3\t159553\t8.5\t40118\t9.3\t27769\t8.9\t97219\t992221\t941097\t51124\t5.2\t112933\t61611\t102357\t40746\t53447\t69633\t-16186\t23498\t14114\t24362\t10248\t10014\t17385\t-7371\nEl Dorado County\t2014\t1067.5\t5017.1\t20715\t11.4\t4956\t13.1\t3405\t11.5\t70235\t88114\t81968\t6146\t7.0\t2030\t688\t6652\t5964\t1284\t719\t565\t1545\t40\t1526\t1486\t1507\t177\t1330\nKern County\t2014\t3532.7\t18995.8\t206604\t24.5\t83543\t32.9\t57763\t31.9\t47451\t393459\t352504\t40955\t10.4\t34958\t38199\t61710\t23511\t-2517\t7431\t-9948\t8666\t9000\t14763\t5763\t67\t1842\t-1775\nButte County\t2014\t1147.2\t11767.3\t48151\t21.9\t10825\t24.3\t7829\t24.2\t42302\t101483\t92708\t8775\t8.6\t4241\t688\t10200\t9512\t3513\t1077\t2436\t1821\t122\t2409\t2287\t1678\t274\t1404\nCalaveras County\t2014\tnull\tnull\t6057\t13.7\t1577\t20.6\t1091\t18.5\t53321\t20292\t18668\t1624\t8.0\t-954\t-533\t1467\t2000\t-323\t88\t-411\t10\t-133\t357\t490\t177\t21\t156\nSan Benito County\t2014\t367.9\t1347.1\t8162\t14.1\t3056\t19.8\t2055\t17.8\t68166\t29241\t26513\t2728\t9.3\t2998\t1909\t3090\t1181\t1112\t261\t851\t673\t426\t721\t295\t272\t69\t203\nNapa County\t2014\t582.8\t4439.8\t12317\t9.0\t3660\t12.0\t2558\t11.2\t71063\t73592\t69417\t4175\t5.7\t5137\t1208\t6314\t5106\t3924\t1963\t1961\t1087\t205\t1446\t1241\t911\t487\t424\nFresno County\t2014\t3922.7\t20532.0\t261387\t27.5\t104770\t38.0\t71200\t36.3\t43338\t439300\t388435\t50865\t11.6\t35522\t41039\t68262\t27223\t-5425\t8378\t-13803\t9872\t9256\t15977\t6721\t821\t2152\t-1331\nSanta Cruz County\t2014\t1768.2\t16401.1\t42076\t16.1\t10217\t19.1\t7149\t18.6\t64257\t142647\t130163\t12484\t8.8\t9442\t5958\t13337\t7379\t3463\t1622\t1841\t2360\t1301\t3105\t1804\t1105\t427\t678\nTuolumne County\t2014\tnull\tnull\t7177\t14.3\t1813\t20.5\t1239\t18.9\t49476\t21628\t19757\t1871\t8.7\t-1534\t-539\t1935\t2474\t-954\t201\t-1155\t-80\t-90\t465\t555\t28\t53\t-25\nLake County\t2014\t650.4\t4566.2\t15387\t24.3\t4119\t32.3\t2974\t32.8\t36333\t29352\t26727\t2625\t8.9\t-481\t-250\t3092\t3342\t-138\t48\t-186\t341\t-38\t731\t769\t395\t17\t378\nLos Angeles County\t2014\t24109.9\t171700.0\t1863025\t18.7\t605129\t26.7\t429259\t26.4\t55686\t5004087\t4591068\t413019\t8.3\t298041\t304568\t558921\t254353\t3777\t211266\t-207489\t62710\t68605\t131668\t63063\t-932\t52572\t-53504\nMarin County\t2014\t749.7\t9944.5\t22272\t8.8\t5357\t10.1\t3467\t8.6\t94549\t139122\t133186\t5936\t4.3\t8341\t1973\t9831\t7858\t6698\t3710\t2988\t1929\t423\t2256\t1833\t1648\t924\t724\nSan Bernardino County\t2014\t8804.7\t61818.7\t422405\t20.4\t159554\t28.2\t113001\t27.4\t51951\t907537\t834901\t72636\t8.0\t77404\t76612\t130705\t54093\t559\t17580\t-17021\t19313\t17247\t30733\t13486\t2408\t4277\t-1869\nStanislaus County\t2014\t2438.7\t22497.4\t95456\t18.1\t34198\t23.8\t23015\t22.0\t50917\t241157\t214219\t26938\t11.2\t17546\t16527\t32444\t15917\t938\t5320\t-4382\t5711\t3803\t7550\t3747\t2002\t1366\t636\nMendocino County\t2014\t846.2\t3479.4\t16256\t18.8\t4924\t26.2\t3270\t24.5\t42840\t40479\t37647\t2832\t7.0\t29\t1241\t4676\t3435\t-1063\t409\t-1472\t398\t321\t1138\t817\t159\t98\t61\nYuba County\t2014\t1745.3\t10875.9\t15693\t21.6\t5802\t28.6\t3802\t26.6\t41403\t27962\t24829\t3133\t11.2\t1811\t3089\t5243\t2154\t-1169\t661\t-1830\t605\t735\t1217\t482\t-88\t157\t-245\nMadera County\t2014\t1174.7\t4599.2\t32542\t22.3\t12871\t30.7\t8619\t28.4\t43171\t61953\t55013\t6940\t11.2\t3683\t5557\t9823\t4266\t-1705\t778\t-2483\t2383\t1264\t2224\t960\t1146\t207\t939\nSutter County\t2014\tnull\tnull\t14485\t15.2\t5200\t20.8\t3584\t19.3\t51827\t44394\t38781\t5613\t12.6\t1110\t2323\t5490\t3167\t-1292\t2086\t-3378\t560\t531\t1260\t729\t31\t516\t-485\nYolo County\t2014\t1173.1\t7863.4\t39493\t19.5\t7788\t17.5\t5304\t16.4\t54509\t102474\t94763\t7711\t7.5\t6740\t5271\t10299\t5028\t1345\t4394\t-3049\t2105\t1254\t2455\t1201\t848\t1092\t-244\nLassen County\t2014\t711.1\t2093.3\t4473\t19.4\t1069\t20.3\t717\t18.7\t49995\t10843\t9856\t987\t9.1\t-3146\t301\t1270\t969\t-3471\t133\t-3604\t-463\t75\t286\t211\t-543\t34\t-577\nVentura County\t2014\t2095.7\t15255.8\t95912\t11.5\t31764\t15.8\t21410\t14.5\t74967\t431107\t402455\t28652\t6.6\t22758\t23133\t45529\t22396\t-544\t7266\t-7810\t5206\t5005\t10602\t5597\t310\t1840\t-1530\nAlameda County\t2014\t5079.0\t46150.7\t197984\t12.5\t48750\t14.3\t33524\t13.8\t76996\t809983\t762878\t47105\t5.8\t100660\t42556\t82793\t40237\t59746\t44678\t15068\t27695\t9962\t19989\t10027\t18430\t11155\t7275\nPlacer County\t2014\t732.4\t9592.7\t30490\t8.3\t8188\t9.7\t5108\t8.0\t75689\t175888\t164871\t11017\t6.3\t23200\t3767\t15877\t12110\t18912\t2788\t16124\t4355\t784\t3708\t2924\t3229\t699\t2530\nOrange County\t2014\t5025.3\t51431.4\t400252\t12.9\t126952\t17.9\t89899\t17.3\t76061\t1572653\t1486383\t86270\t5.5\t135246\t84551\t162288\t77737\t52028\t53174\t-1146\t23661\t19222\t38295\t19073\t5455\t13400\t-7945\nTehama County\t2014\t914.7\t6459.6\t11358\t18.2\t3956\t26.7\t2703\t24.8\t40782\t25144\t22726\t2418\t9.6\t-394\t742\t3248\t2506\t-1130\t258\t-1388\t-63\t181\t773\t592\t-259\t63\t-322\nSan Luis Obispo County\t2014\t2314.4\t13768.7\t38048\t14.5\t7765\t15.6\t5259\t14.5\t61775\t140565\t132727\t7838\t5.6\t9490\t1692\t11123\t9431\t7564\t928\t6636\t2799\t411\t2610\t2199\t2267\t245\t2022\nTulare County\t2014\t3427.5\t18640.1\t127305\t28.1\t52542\t36.7\t37023\t36.1\t42360\t198635\t172550\t26085\t13.1\t16016\t22261\t34179\t11918\t-5743\t1500\t-7243\t3473\t5157\t8019\t2862\t-1477\t439\t-1916\nRiverside County\t2014\t6966.0\t70486.9\t392706\t17.1\t141970\t23.5\t100349\t22.5\t56877\t1013481\t930412\t83069\t8.2\t139514\t66310\t129896\t63586\t71401\t17172\t54229\t32315\t14988\t30694\t15706\t16605\t4377\t12228\nMerced County\t2014\t2051.5\t10982.5\t64585\t24.8\t28341\t35.9\t18269\t31.8\t43818\t114589\t99887\t14702\t12.8\t10555\t11399\t18116\t6717\t-679\t2151\t-2830\t2872\t2642\t4267\t1625\t373\t558\t-185\nSonoma County\t2014\t1893.9\t9837.0\t55742\t11.3\t13770\t13.6\t9529\t12.7\t66949\t256742\t242339\t14403\t5.6\t16412\t5260\t22052\t16792\t10856\t2722\t8134\t4860\t1081\t5196\t4115\t3560\t701\t2859\nSacramento County\t2014\t1621.0\t10352.7\t264955\t18.1\t84938\t23.8\t57267\t22.2\t55803\t680676\t630973\t49703\t7.3\t63284\t39224\t84065\t44841\t23552\t21534\t2018\t18877\t8735\t19720\t10985\t10004\t5465\t4539\nShasta County\t2014\t1610.6\t10355.3\t26016\t14.7\t7682\t20.3\t5411\t19.7\t43661\t75047\t67830\t7217\t9.6\t2581\t166\t8866\t8700\t2201\t894\t1307\t667\t49\t2107\t2058\t630\t228\t402\nSan Joaquin County\t2014\t2301.1\t14953.2\t145167\t20.7\t53907\t27.5\t38015\t26.5\t51527\t312782\t279832\t32950\t10.5\t30289\t22600\t43512\t20912\t7325\t6981\t344\t10570\t5004\t10078\t5074\t5560\t1771\t3789\nKings County\t2014\t1533.2\t8392.0\t33174\t24.9\t13840\t33.8\t9448\t32.4\t44490\t57578\t50717\t6861\t11.9\t-2713\t6959\t10344\t3385\t-9845\t1582\t-11427\t-593\t1527\t2345\t818\t-2145\t359\t-2504\nSanta Barbara County\t2014\t1361.5\t10356.3\t73600\t17.4\t21781\t22.6\t14859\t21.7\t62116\t218314\t204973\t13341\t6.1\t16729\t11655\t24146\t12491\t5121\t5602\t-481\t4592\t2623\t5636\t3013\t2048\t1420\t628\nImperial County\t2014\t924.9\t13179.5\t40162\t23.6\t15870\t31.3\t11184\t31.2\t38737\t78445\t59598\t18847\t24.0\t4563\t8999\t12966\t3967\t-4593\t1075\t-5668\t1574\t2093\t3028\t935\t-531\t288\t-819\nNevada County\t2014\t964.5\t6305.6\t11193\t11.4\t3043\t17.6\t2164\t16.6\t57118\t47961\t44820\t3141\t6.5\t145\t-458\t3369\t3827\t830\t263\t567\t631\t-62\t815\t877\t776\t67\t709\nSan Diego County\t2014\t3878.7\t26505.3\t467248\t14.7\t135884\t18.9\t93941\t18.6\t66034\t1544314\t1445086\t99228\t6.4\t168123\t102506\t188675\t86169\t65485\t62219\t3266\t40873\t23732\t44860\t21128\t17186\t14637\t2549\nHumboldt County\t2014\t1260.5\t16282.4\t27609\t21.0\t6137\t23.9\t4240\t23.1\t40581\t62505\t58346\t4159\t6.7\t186\t994\t6328\t5334\t-636\t410\t-1046\t189\t184\t1476\t1292\t82\t97\t-15\nSolano County\t2014\t2224.3\t16398.4\t51638\t12.3\t16144\t16.5\t10742\t15.0\t67106\t203266\t187972\t15294\t7.5\t17787\t9043\t21742\t12699\t8558\t6464\t2094\t5912\t1976\t5151\t3175\t3814\t1523\t2291\nMonterey County\t2014\t3640.0\t20505.4\t70259\t17.0\t28122\t25.2\t18945\t24.1\t57428\t218226\t198499\t19727\t9.0\t16287\t18424\t28447\t10023\t-1696\t4525\t-6221\t2221\t4163\t6613\t2450\t-1833\t1141\t-2974\nSan Mateo County\t2014\t2671.4\t25337.8\t56580\t7.5\t15725\t9.8\t10911\t9.5\t100806\t427907\t409873\t18034\t4.2\t40083\t18856\t38945\t20089\t22252\t18754\t3498\t8092\t4369\t9267\t4898\t3888\t4676\t-788\n"}]},"apps":[],"jobName":"paragraph_1524756650623_425365139","id":"20180426-163050_1853013184","dateCreated":"2018-04-26T16:30:50+0900","dateStarted":"2018-05-07T17:17:32+0900","dateFinished":"2018-05-07T17:17:33+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:209"},{"text":"val crimeFeatures2014 = crimeFeatures\n  .filter($\"violent_crime_rate\".isNotNull && $\"property_crime_rate\".isNotNull)\n  .filter($\"year\" === 2014)\n  .drop(\"county\")","user":"anonymous","dateUpdated":"2018-05-07T17:17:44+0900","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"crimeFeatures2014: org.apache.spark.sql.DataFrame = [year: int, violent_crime_rate: double ... 26 more fields]\n"}]},"apps":[],"jobName":"paragraph_1524756695667_1417709173","id":"20180426-163135_671087633","dateCreated":"2018-04-26T16:31:35+0900","dateStarted":"2018-05-07T17:17:44+0900","dateFinished":"2018-05-07T17:17:45+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:210"},{"text":"val rdd = crimeFeatures2014\n  .select(array(crimeFeatures2014.columns.map(col(_)): _*))\n  .rdd\n  .map(_.getSeq[Double](0).toArray)\n  .map(org.apache.spark.mllib.linalg.Vectors.dense(_))\n","user":"anonymous","dateUpdated":"2018-05-07T17:17:49+0900","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rdd: org.apache.spark.rdd.RDD[org.apache.spark.mllib.linalg.Vector] = MapPartitionsRDD[21] at map at <console>:36\n"}]},"apps":[],"jobName":"paragraph_1524767286287_-1836452475","id":"20180426-192806_1302242966","dateCreated":"2018-04-26T19:28:06+0900","dateStarted":"2018-05-07T17:17:49+0900","dateFinished":"2018-05-07T17:17:50+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:211"},{"text":"import org.apache.spark.mllib.stat.Statistics\n\nval corrMatrix = Statistics.corr(rdd)","user":"anonymous","dateUpdated":"2018-05-07T17:17:54+0900","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.mllib.stat.Statistics\ncorrMatrix: org.apache.spark.mllib.linalg.Matrix =\n1.0  NaN                    NaN                    ... (28 total)\nNaN  1.0                    0.9765477451602552     ...\nNaN  0.9765477451602552     1.0                    ...\nNaN  0.9617591814961493     0.9317100728219957     ...\nNaN  0.06857677173290778    -0.027079627461929788  ...\nNaN  0.9665529241543729     0.9314434966328518     ...\nNaN  0.13354978924291866    0.03300771655740109    ...\nNaN  0.9677910586768841     0.9332979334479454     ...\nNaN  0.1591911774981941     0.06326893135298375    ...\nNaN  0.02550530648180013    0.12337965605166189    ...\nNaN  0.9346373511893254     0.9302662028760682     ...\nNaN  0.9314694740809975     0.9287622980346388     ...\nNaN  0.9581532478740015     0.9345293605901512     ...\nNaN  -0.051309910873..."}]},"apps":[],"jobName":"paragraph_1524757233089_-57852120","id":"20180426-164033_1999909160","dateCreated":"2018-04-26T16:40:33+0900","dateStarted":"2018-05-07T17:17:54+0900","dateFinished":"2018-05-07T17:17:56+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:212"},{"text":"z.show(corrMatrix)","user":"anonymous","dateUpdated":"2018-05-07T17:17:59+0900","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1.0  NaN                    NaN                    ... (28 total)\nNaN  1.0                    0.9765477451602552     ...\nNaN  0.9765477451602552     1.0                    ...\nNaN  0.9617591814961493     0.9317100728219957     ...\nNaN  0.06857677173290778    -0.027079627461929788  ...\nNaN  0.9665529241543729     0.9314434966328518     ...\nNaN  0.13354978924291866    0.03300771655740109    ...\nNaN  0.9677910586768841     0.9332979334479454     ...\nNaN  0.1591911774981941     0.06326893135298375    ...\nNaN  0.02550530648180013    0.12337965605166189    ...\nNaN  0.9346373511893254     0.9302662028760682     ...\nNaN  0.9314694740809975     0.9287622980346388     ...\nNaN  0.9581532478740015     0.9345293605901512     ...\nNaN  -0.051309910873788875  -0.09715673500937873   ...\nNaN  0.8507784831094393     0.8886381392345006     ...\nNaN  0.9435680147187864     0.9261299383711518     ...\nNaN  0.9438706948741686     0.9316063083681759     ...\nNaN  0.9393285034072202     0.9334161525128813     ...\nNaN  0.18998868894313156    0.33742372533759885    ...\nNaN  0.8792419900712166     0.8775700126440891     ...\nNaN  -0.7943836050070787    -0.7030042833458569    ...\nNaN  0.8291828304434038     0.8636713644543499     ...\nNaN  0.9416495018904832     0.9244441523315309     ...\nNaN  0.9433013083965222     0.931445621912572      ...\nNaN  0.9402369488963828     0.9343708300680651     ...\nNaN  0.12791255297931303    0.2500664108174415     ...\nNaN  0.8807864375997971     0.8798096651691255     ...\nNaN  -0.7874871172845442    -0.7185028652520338    ..."}]},"apps":[],"jobName":"paragraph_1524757593680_1013229689","id":"20180426-164633_930041274","dateCreated":"2018-04-26T16:46:33+0900","dateStarted":"2018-05-07T17:17:59+0900","dateFinished":"2018-05-07T17:17:59+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:213"},{"text":"// The code below only works with Spark 2.3.0 and as of May 2018, Zeppelin doesn't support Spark 2.3.0\n// So DON'T run this cell\nimport org.apache.spark.ml.feature.VectorAssembler\nimport org.apache.spark.ml.linalg.Matrix\nimport org.apache.spark.ml.stat.Correlation\nimport org.apache.spark.sql.Row\n\nval filteredCrimeFeatures = crimeFeatures\n  .filter($\"violent_crime_rate\".isNotNull && $\"property_crime_rate\".isNotNull)\n\nval assembler = new VectorAssembler()\n  .setInputCols(filteredCrimeFeatures.columns.filter(_ != \"county\"))\n  .setOutputCol(\"features\")\n\nval df = assembler.transform(filteredCrimeFeatures)\n\ndf.printSchema\n\nval Row(coeff1: Matrix) = Correlation.corr(df, \"features\").head\n\nprintln(s\"Pearson correlation matrix:\\n $coeff1\")\n","user":"anonymous","dateUpdated":"2018-05-07T17:32:40+0900","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524767402932_335976088","id":"20180426-193002_1298850762","dateCreated":"2018-04-26T19:30:02+0900","dateStarted":"2018-05-07T16:40:14+0900","dateFinished":"2018-05-07T16:40:14+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:214","errorMessage":""},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1525679241521_165471454","id":"20180507-164721_1959714332","dateCreated":"2018-05-07T16:47:21+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:220"}],"name":"Correlation Analysis","id":"2DCD7QT2D","angularObjects":{"2D9ERVFZT:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}