{"paragraphs":[{"text":"import spark.implicits._","user":"anonymous","dateUpdated":"2018-04-25T18:13:46+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\n"}]},"apps":[],"jobName":"paragraph_1524601135328_-1200401126","id":"20180424-211855_464794150","dateCreated":"2018-04-24T21:18:55+0100","dateStarted":"2018-04-25T18:13:46+0100","dateFinished":"2018-04-25T18:13:59+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4792"},{"text":"val crimeCADF = spark.read\n  .option(\"inferSchema\", true)\n  .option(\"header\", true)\n  .option(\"basePath\", \"/Users/kc250033/dev/us-crime-analysis/data/crime/counties\")\n  .csv(\"/Users/kc250033/dev/us-crime-analysis/data/crime/counties\")\n  \ncrimeCADF.printSchema\n","user":"anonymous","dateUpdated":"2018-04-25T22:06:28+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"crimeCADF: org.apache.spark.sql.DataFrame = [Agency: string, State: string ... 23 more fields]\nroot\n |-- Agency: string (nullable = true)\n |-- State: string (nullable = true)\n |-- Months: integer (nullable = true)\n |-- Population: double (nullable = true)\n |-- Violent crime total: double (nullable = true)\n |-- Murder and nonnegligent Manslaughter: double (nullable = true)\n |-- Legacy rape /1: double (nullable = true)\n |-- Revised rape /2: double (nullable = true)\n |-- Robbery: double (nullable = true)\n |-- Aggravated assault: double (nullable = true)\n |-- Property crime total: double (nullable = true)\n |-- Burglary: double (nullable = true)\n |-- Larceny-theft: double (nullable = true)\n |-- Motor vehicle theft: double (nullable = true)\n |-- Violent Crime rate: double (nullable = true)\n |-- Murder and nonnegligent manslaughter rate: double (nullable = true)\n |-- Legacy rape rate /1: double (nullable = true)\n |-- Revised rape rate /2: double (nullable = true)\n |-- Robbery rate: double (nullable = true)\n |-- Aggravated assault rate: double (nullable = true)\n |-- Property crime rate: double (nullable = true)\n |-- Burglary rate: double (nullable = true)\n |-- Larceny-theft rate: double (nullable = true)\n |-- Motor vehicle theft rate: double (nullable = true)\n |-- year: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1524601157832_-836028594","id":"20180424-211917_847234885","dateCreated":"2018-04-24T21:19:17+0100","dateStarted":"2018-04-25T22:06:28+0100","dateFinished":"2018-04-25T22:06:28+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4793"},{"text":"val agencyCountyDF = spark.read\n  .option(\"inferSchema\", true)\n  .option(\"header\", true)\n  .csv(\"/Users/kc250033/dev/us-crime-analysis/data/agency-county\")\n  \nagencyCountyDF.printSchema\n  ","user":"anonymous","dateUpdated":"2018-04-25T23:16:35+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"agencyCountyDF: org.apache.spark.sql.DataFrame = [agency: string, county: string]\nroot\n |-- agency: string (nullable = true)\n |-- county: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1524689310524_1797655312","id":"20180425-214830_2059021822","dateCreated":"2018-04-25T21:48:30+0100","dateStarted":"2018-04-25T23:16:35+0100","dateFinished":"2018-04-25T23:16:35+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4794"},{"text":"val crimeCountyDF = crimeCADF.join(agencyCountyDF, crimeCADF(\"Agency\") === agencyCountyDF(\"agency\"), \"inner\")\n  .select(\"county\", \"Violent crime rate\", \"year\")\n  .filter($\"year\" === 2014)\n  .filter($\"Violent crime rate\".isNotNull)\n  .groupBy(\"county\", \"year\")\n  .agg(sum(\"Violent crime rate\").as(\"violent_crime_rate\"))\n\ncrimeCountyDF.printSchema","user":"anonymous","dateUpdated":"2018-04-25T23:29:48+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"crimeCountyDF: org.apache.spark.sql.DataFrame = [county: string, year: int ... 1 more field]\nroot\n |-- county: string (nullable = true)\n |-- year: integer (nullable = true)\n |-- violent_crime_rate: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1524601186556_-2142205137","id":"20180424-211946_1260294891","dateCreated":"2018-04-24T21:19:46+0100","dateStarted":"2018-04-25T23:29:48+0100","dateFinished":"2018-04-25T23:29:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4795"},{"text":"z.show(crimeCountyDF.sort(desc(\"violent_crime_rate\")))\n","user":"anonymous","dateUpdated":"2018-04-25T23:29:51+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"county\tyear\tviolent_crime_rate\nLos Angeles County\t2014\t18995.9\nRiverside County\t2014\t6655.2\nSan Bernardino County\t2014\t6336.999999999999\nAlameda County\t2014\t4662.900000000001\nContra Costa County\t2014\t4044.5999999999995\nOrange County\t2014\t3824.7\nFresno County\t2014\t3531.1\nKern County\t2014\t3265.8\nSan Diego County\t2014\t3103.5\nMonterey County\t2014\t2461.5\nTulare County\t2014\t2308.9\nMerced County\t2014\t2051.5\nSan Mateo County\t2014\t1955.4\nStanislaus County\t2014\t1913.2\nSan Luis Obispo County\t2014\t1800.2\nShasta County\t2014\t1610.6\nKings County\t2014\t1533.1999999999998\nYuba County\t2014\t1405.0\nVentura County\t2014\t1352.6\nSanta Clara County\t2014\t1339.1\nHumboldt County\t2014\t1260.5\nMadera County\t2014\t1174.7\nButte County\t2014\t1147.2\nSacramento County\t2014\t1006.1999999999999\nImperial County\t2014\t924.9000000000001\nTehama County\t2014\t914.7\nSonoma County\t2014\t883.8\nNevada County\t2014\t853.1\nSolano County\t2014\t841.5\nSan Joaquin County\t2014\t818.0\nLake County \t2014\t650.4\nSanta Barbara County\t2014\t602.5\nPlacer County\t2014\t582.8000000000001\nNapa County\t2014\t582.8\nEl Dorado County\t2014\t543.6\nMarin County\t2014\t424.20000000000005\nSan Benito County\t2014\t367.9\nSanta Cruz County\t2014\t296.0\nYolo County\t2014\t126.6\n"}]},"apps":[],"jobName":"paragraph_1524601202709_-1408109693","id":"20180424-212002_554543769","dateCreated":"2018-04-24T21:20:02+0100","dateStarted":"2018-04-25T23:29:51+0100","dateFinished":"2018-04-25T23:29:51+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4796"},{"text":"val incomeDF = spark.read\n  .option(\"inferSchema\", true)\n  .option(\"header\", true)\n  .option(\"basePath\", \"/Users/kc250033/dev/us-crime-analysis/data/income/counties\")\n  .csv(\"/Users/kc250033/dev/us-crime-analysis/data/income/counties\")\n  \nincomeDF.printSchema","user":"anonymous","dateUpdated":"2018-04-25T23:30:11+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"incomeDF: org.apache.spark.sql.DataFrame = [State FIPS: string, County FIPS: string ... 30 more fields]\nroot\n |-- State FIPS: string (nullable = true)\n |-- County FIPS: string (nullable = true)\n |-- Postal: string (nullable = true)\n |-- Name: string (nullable = true)\n |-- Poverty Estimate All Ages: string (nullable = true)\n |-- 90% CI Lower Bound5: string (nullable = true)\n |-- 90% CI Upper Bound6: string (nullable = true)\n |-- Poverty Percent All Ages: string (nullable = true)\n |-- 90% CI Lower Bound8: string (nullable = true)\n |-- 90% CI Upper Bound9: string (nullable = true)\n |-- Poverty Estimate Under Age 18: string (nullable = true)\n |-- 90% CI Lower Bound11: string (nullable = true)\n |-- 90% CI Upper Bound12: string (nullable = true)\n |-- Poverty Percent Under Age 18: string (nullable = true)\n |-- 90% CI Lower Bound14: string (nullable = true)\n |-- 90% CI Upper Bound15: string (nullable = true)\n |-- Poverty Estimate Ages 5-17: string (nullable = true)\n |-- 90% CI Lower Bound17: string (nullable = true)\n |-- 90% CI Upper Bound18: string (nullable = true)\n |-- Poverty Percent Ages 5-17: string (nullable = true)\n |-- 90% CI Lower Bound20: string (nullable = true)\n |-- 90% CI Upper Bound21: string (nullable = true)\n |-- Median Household Income: string (nullable = true)\n |-- 90% CI Lower Bound23: string (nullable = true)\n |-- 90% CI Upper Bound24: string (nullable = true)\n |-- Poverty Estimate Ages 0-4: string (nullable = true)\n |-- 90% CI Lower Bound26: string (nullable = true)\n |-- 90% CI Upper Bound27: string (nullable = true)\n |-- Poverty Percent Ages 0-4: string (nullable = true)\n |-- 90% CI Lower Bound29: string (nullable = true)\n |-- 90% CI Upper Bound30: string (nullable = true)\n |-- year: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1524684561015_1467356342","id":"20180425-202921_313616639","dateCreated":"2018-04-25T20:29:21+0100","dateStarted":"2018-04-25T23:30:11+0100","dateFinished":"2018-04-25T23:30:12+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4797"},{"text":"val crimeFeaturesDF = crimeCountyDF.join(incomeDF, $\"county\" === $\"Name\" && incomeDF(\"year\") === crimeCountyDF(\"year\"), \"inner\")\n  .select($\"county\", incomeDF(\"year\"), $\"Poverty Percent All Ages\", $\"Median Household Income\", $\"violent_crime_rate\")\n  \ncrimeFeaturesDF.printSchema","user":"anonymous","dateUpdated":"2018-04-25T23:35:29+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"crimeFeaturesDF: org.apache.spark.sql.DataFrame = [county: string, year: int ... 3 more fields]\nroot\n |-- county: string (nullable = true)\n |-- year: integer (nullable = true)\n |-- Poverty Percent All Ages: string (nullable = true)\n |-- Median Household Income: string (nullable = true)\n |-- violent_crime_rate: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1524691095764_-727672312","id":"20180425-221815_222369640","dateCreated":"2018-04-25T22:18:15+0100","dateStarted":"2018-04-25T23:35:00+0100","dateFinished":"2018-04-25T23:35:00+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4798"},{"text":"z.show(crimeFeaturesDF.sort(desc(\"Median Household Income\")))","user":"anonymous","dateUpdated":"2018-04-25T23:38:14+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"county\tyear\tPoverty Percent All Ages\tMedian Household Income\tviolent_crime_rate\nSanta Clara County\t2014\t8.5\t97219\t1339.1\nMarin County\t2014\t8.8\t94549\t424.20000000000005\nContra Costa County\t2014\t10.5\t80338\t4044.5999999999995\nAlameda County\t2014\t12.5\t76996\t4662.900000000001\nOrange County\t2014\t12.9\t76061\t3824.7\nPlacer County\t2014\t8.3\t75689\t582.8000000000001\nVentura County\t2014\t11.5\t74967\t1352.6\nNapa County\t2014\t9\t71063\t582.8\nEl Dorado County\t2014\t11.4\t70235\t543.6\nOrange County\t2014\t13.4\t69228\t3824.7\nSan Benito County\t2014\t14.1\t68166\t367.9\nHumboldt County\t2014\t10.7\t67423\t1260.5\nSolano County\t2014\t12.3\t67106\t841.5\nSonoma County\t2014\t11.3\t66949\t883.8\nSan Diego County\t2014\t14.7\t66034\t3103.5\nSanta Cruz County\t2014\t16.1\t64257\t296.0\nSanta Barbara County\t2014\t17.4\t62116\t602.5\nSan Luis Obispo County\t2014\t14.5\t61775\t1800.2\nOrange County\t2014\t14.1\t60304\t3824.7\nOrange County\t2014\t10.7\t59282\t3824.7\nMonterey County\t2014\t17\t57428\t2461.5\nNevada County\t2014\t11.4\t57118\t853.1\nRiverside County\t2014\t17.1\t56877\t6655.2\nSacramento County\t2014\t18.1\t55803\t1006.1999999999999\nLos Angeles County\t2014\t18.7\t55686\t18995.9\nYolo County\t2014\t19.5\t54509\t126.6\nOrange County\t2014\t12.8\t53025\t3824.7\nSan Bernardino County\t2014\t20.4\t51951\t6336.999999999999\nSan Joaquin County\t2014\t20.7\t51527\t818.0\nStanislaus County\t2014\t18.1\t50917\t1913.2\nHumboldt County\t2014\t10.1\t49696\t1260.5\nOrange County\t2014\t16\t48834\t3824.7\nKings County\t2014\t23.4\t47547\t1533.1999999999998\nKern County\t2014\t24.5\t47451\t3265.8\nOrange County\t2014\t18.2\t47069\t3824.7\nKings County\t2014\t24.9\t44490\t1533.1999999999998\nMerced County\t2014\t24.8\t43818\t2051.5\nShasta County\t2014\t14.7\t43661\t1610.6\nFresno County\t2014\t27.5\t43338\t3531.1\nMadera County\t2014\t22.3\t43171\t1174.7\nButte County\t2014\t14.8\t42907\t1147.2\nTulare County\t2014\t28.1\t42360\t2308.9\nButte County\t2014\t21.9\t42302\t1147.2\nButte County\t2014\t15.8\t41446\t1147.2\nYuba County\t2014\t21.6\t41403\t1405.0\nTehama County\t2014\t18.2\t40782\t914.7\nHumboldt County\t2014\t21\t40581\t1260.5\nOrange County\t2014\t18\t39572\t3824.7\nImperial County\t2014\t23.6\t38737\t924.9000000000001\nSanta Cruz County\t2014\t23.6\t37465\t296.0\nNevada County\t2014\t25.1\t30935\t853.1\nSan Mateo County\t2014\t7.5\t100806\t1955.4\n"}]},"apps":[],"jobName":"paragraph_1524693301963_333004308","id":"20180425-225501_1894483289","dateCreated":"2018-04-25T22:55:01+0100","dateStarted":"2018-04-25T23:38:14+0100","dateFinished":"2018-04-25T23:38:15+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4799"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1524693569647_-1830258679","id":"20180425-225929_175216455","dateCreated":"2018-04-25T22:59:29+0100","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:4800"}],"name":"US Crime Analysis","id":"2DBNQZM6T","angularObjects":{"2D9ERVFZT:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}